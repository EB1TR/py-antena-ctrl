<!doctype html>
<html lang="es">
        <head>
                <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
                <script src="mqtt.js" type="text/javascript"></script>
                <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
                <link rel="stylesheet" href="style.css">
                <meta charset="utf-8">
                <title>Antenna Control</title>
        </head>
        <body style="text-align: center">
                <div id="contenor">
                        <table class="tablestn">
                                <tr>
                                        <td class="colcentered texto-stn" colspan="11">
                                                <span style="width: 60px; display: inline-block; align-content: center;">STN1: </span>
                                                <span style="width: 100px; display: inline-block; align-content: center;" id="stn1-r1-qrg">----.--</span>
                                                <span style="width: 80px; display: inline-block; align-content: center;" id="stn1-r1-pwr">---</span>
                                                <span style="width: 80px; display: inline-block; align-content: center;" id="stn1-r1-pwrp">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn1-r1-swr">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn1-r1-va">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn1-r1-temp">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn1-r1-fun">---</span>
                                        </td>
                                </tr>
                                <tr>
                                        <td colspan="5"><hr></td>
                                        <td colspan="1">Banda</td>
                                        <td colspan="5"><hr></td>
                                </tr>
                                <tr>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 0)" class="spanitem" id="stn1-b0">N/A</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 160)" class="spanitem" id="stn1-b160">160m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 80)" class="spanitem" id="stn1-b80">80m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 60)" class="spanitem" id="stn1-b60">60m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 40)" class="spanitem" id="stn1-b40">40m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 30)" class="spanitem" id="stn1-b30">30m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 20)" class="spanitem" id="stn1-b20">20m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 17)" class="spanitem" id="stn1-b17">17m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 15)" class="spanitem" id="stn1-b15">15m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 12)" class="spanitem" id="stn1-b12">12m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/band', 10)" class="spanitem" id="stn1-b10">10m</span></a></td>
                                </tr>
                                <tr>
                                        <td colspan="5"><hr></td>
                                        <td colspan="1">Antena</td>
                                        <td colspan="5"><hr></td>
                                </tr>
                                <tr>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/stack', 1)" class="spanitem" id="stn1-stack1">1</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/stack', 2)" class="spanitem" id="stn1-stack2">2</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/stack', 3)" class="spanitem" id="stn1-stack3">3</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/nostack', 1)" class="spanitemtw spanitemtwy" id="stn1-nostack">SWAP</span></a></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/rig', 0)" class="spanitem" id="stn1-rig">RIG</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn1/antm', 0)" class="spanitem" id="stn1-as">AUTO</span></a></td>
                                </tr>
                        </table>
                        <br><br>
                        <table class="tablestn">
                                <tr>
                                        <td class="colcentered texto-stn" colspan="11">
                                                <span style="width: 60px; display: inline-block; align-content: center;">STN2: </span>
                                                <span style="width: 100px; display: inline-block; align-content: center;" id="stn2-r1-qrg">----.--</span>
                                                <span style="width: 80px; display: inline-block; align-content: center;" id="stn2-r1-pwr">---</span>
                                                <span style="width: 80px; display: inline-block; align-content: center;" id="stn2-r1-pwrp">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn2-r1-swr">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn2-r1-va">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn2-r1-temp">---</span>
                                                <span style="width: 60px; display: inline-block; align-content: center;" id="stn2-r1-fun">---</span>
                                        </td>
                                </tr>
                                <tr>
                                        <td colspan="5"><hr></td>
                                        <td colspan="1">Banda</td>
                                        <td colspan="5"><hr></td>
                                </tr>
                                <tr>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 0)" class="spanitem" id="stn2-b0">N/A</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 160)" class="spanitem" id="stn2-b160">160m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 80)" class="spanitem" id="stn2-b80">80m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 60)" class="spanitem" id="stn2-b60">60m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 40)" class="spanitem" id="stn2-b40">40m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 30)" class="spanitem" id="stn2-b30">30m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 20)" class="spanitem" id="stn2-b20">20m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 17)" class="spanitem" id="stn2-b17">17m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 15)" class="spanitem" id="stn2-b15">15m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 12)" class="spanitem" id="stn2-b12">12m</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/band', 10)" class="spanitem" id="stn2-b10">10m</span></a></td>
                                </tr>
                                <tr>
                                        <td colspan="5"><hr></td>
                                        <td colspan="1">Antena</td>
                                        <td colspan="5"><hr></td>
                                </tr>
                                <tr>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/stack', 1)" class="spanitem" id="stn2-stack1">1</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/stack', 2)" class="spanitem" id="stn2-stack2">2</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/stack', 3)" class="spanitem" id="stn2-stack3">3</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/nostack', 1)" class="spanitemtw spanitemtwy" id="stn2-nostack">SWAP</span></a></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/rig', 0)" class="spanitem" id="stn2-rig">RIG</span></a></td>
                                        <td class="tdstn"><a href="#"><span onclick="send_command('set/stn2/antm', 0)" class="spanitem" id="stn2-as">AUTO</span></a></td>
                                </tr>
                        </table>
                        <br>
                        <table class="tablestn">
                                <tr>
                                        <td class="colcentered texto-stn" colspan="3"><span style="font-size: 24px;">C31XR</span></td>
                                        <td class="tdstn"><a href="#"><span title="PARKING 275º" onclick="send_command('tw3/set/deg', 275)" class="spanitemtw" id="tw3sp0">PARK</span></a></td>
                                        <td class="colcentered texto-stn" colspan="4"><a href="#"><span class="spanitem"  onclick="send_command('tw3/set/mode', 'invert')" style="font-size: 16px;" id="tw3mode">---</span></a></td>
                                        <td class="colcentered texto-stn"><span style="font-size: 24px;" id="tw3set">---</span></td>
                                        <td class="colcentered texto-stn" colspan="2"><span style="font-size: 24px;" id="tw3nec">---</span><br></td>
                                </tr>
                                <tr>
                                        <td><span class="spanitem spanitemw" id="tw3stn1">STN1</span></td>
                                        <td class="tdstn" colspan="3"><a href="#"><span title="-5° TW3" class="spanitemtw spanitemtwy" id="tw3sp_minus" style="height: 52px; line-height: 52px; font-size: 18px;">−</span></a></td>
                                        <td class="colcentered texto-stn" colspan="3"><span style="font-size: 79px;" id="tw3">---</span></td>
                                        <td class="tdstn" colspan="3"><a href="#"><span title="+5° TW3" class="spanitemtw spanitemtwy" id="tw3sp_plus" style="height: 52px; line-height: 52px; font-size: 18px;">+</span></a></td>
                                        <td><span class="spanitem spanitemw" id="tw3stn2">STN2</span></td>
                                </tr>
                                <tr>
                                        <td colspan="5"><hr></td>
                                        <td colspan="1">Presets</td>
                                        <td colspan="5"><hr></td>
                                </tr>
                                <tr>
                                        <td class="tdstn"><a href="#"><span title="10º" onclick="send_command('tw3/set/deg', 10)" class="spanitemtw" id="tw3sp0">10º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="25º" onclick="send_command('tw3/set/deg', 25)" class="spanitemtw" id="tw3sp1">25º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="45º" onclick="send_command('tw3/set/deg', 45)" class="spanitemtw" id="tw3sp2">45º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="60º" onclick="send_command('tw3/set/deg', 60)" class="spanitemtw" id="tw3sp3">60º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="87º" onclick="send_command('tw3/set/deg', 87)" class="spanitemtw" id="tw3sp4">87º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="125º" onclick="send_command('tw3/set/deg', 125)" class="spanitemtw" id="tw3sp5">125º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="205º" onclick="send_command('tw3/set/deg', 205)" class="spanitemtw" id="tw3sp6">205º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="220º" onclick="send_command('tw3/set/deg', 220)" class="spanitemtw" id="tw3sp3">220º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="270º" onclick="send_command('tw3/set/deg', 270)" class="spanitemtw" id="tw3sp4">270º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="300º" onclick="send_command('tw3/set/deg', 300)" class="spanitemtw" id="tw3sp5">300º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="340º" onclick="send_command('tw3/set/deg', 340)" class="spanitemtw" id="tw3sp6">340º</span></a></td>
                                </tr>
                        </table>
                        <br>
                        <table class="tablestn">
                                <tr>
                                        <td class="colcentered texto-stn" colspan="3"><span style="font-size: 24px;">MB7</span></td>
					<td class="tdstn"><a href="#"><span title="PARKING 275º" onclick="send_command('tw1/set/deg', 275)" class="spanitemtw" id="tw1sp0">PARK</span></a></td>
                                        <td class="colcentered texto-stn" colspan="4"><a href="#"><span class="spanitem"  onclick="send_command('tw1/set/mode', 'invert')" style="font-size: 16px;" id="tw1mode">---</span></a></td>
                                        <td class="colcentered texto-stn"><span style="font-size: 24px;" id="tw1set">---</span></td>
                                        <td class="colcentered texto-stn" colspan="2"><span style="font-size: 24px;" id="tw1nec">---</span><br></td>
                                </tr>
                                <tr>
                                        <td><span class="spanitem spanitemw" id="tw1stn1">STN1</span></td>
                                        <td class="tdstn" colspan="3"><a href="#"><span title="-5° TW1" class="spanitemtw spanitemtwy" id="tw1sp_minus" style="height: 52px; line-height: 52px; font-size: 18px;">−</span></a></td>
                                        <td class="colcentered texto-stn" colspan="3"><span style="font-size: 79px;" id="tw1">---</span></td>
                                        <td class="tdstn" colspan="3"><a href="#"><span title="+5° TW1" class="spanitemtw spanitemtwy" id="tw1sp_plus" style="height: 52px; line-height: 52px; font-size: 18px;">+</span></a></td>
                                        <td><span class="spanitem spanitemw" id="tw1stn2">STN2</span></td>
                                </tr>
                                <tr>
                                        <td colspan="5"><hr></td>
                                        <td colspan="1">Presets</td>
                                        <td colspan="5"><hr></td>
                                </tr>
                                <tr>
                                        <td class="tdstn"><a href="#"><span title="10º" onclick="send_command('tw1/set/deg', 10)" class="spanitemtw" id="tw1sp0">10º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="25º" onclick="send_command('tw1/set/deg', 25)" class="spanitemtw" id="tw1sp1">25º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="45º" onclick="send_command('tw1/set/deg', 45)" class="spanitemtw" id="tw1sp2">45º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="60º" onclick="send_command('tw1/set/deg', 60)" class="spanitemtw" id="tw1sp3">60º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="87º" onclick="send_command('tw1/set/deg', 87)" class="spanitemtw" id="tw1sp4">87º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="125º" onclick="send_command('tw1/set/deg', 125)" class="spanitemtw" id="tw1sp5">125º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="205º" onclick="send_command('tw1/set/deg', 205)" class="spanitemtw" id="tw1sp6">205º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="220º" onclick="send_command('tw1/set/deg', 220)" class="spanitemtw" id="tw1sp3">220º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="270º" onclick="send_command('tw1/set/deg', 270)" class="spanitemtw" id="tw1sp4">270º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="300º" onclick="send_command('tw1/set/deg', 300)" class="spanitemtw" id="tw1sp5">300º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="340º" onclick="send_command('tw1/set/deg', 340)" class="spanitemtw" id="tw1sp6">340º</span></a></td>
                                </tr>
                        </table>
                        <br>
                        <table class="tablestn">
                                <tr>
                                        <td class="colcentered texto-stn" colspan="3"><span style="font-size: 24px;">MB4</span></td>
                                        <td class="tdstn"><a href="#"><span title="PARKING 275º" onclick="send_command('tw2/set/deg', 275)" class="spanitemtw" id="tw2sp0">PARK</span></a></td>
                                        <td class="colcentered texto-stn" colspan="4"><a href="#"><span class="spanitem"  onclick="send_command('tw2/set/mode', 'invert')" style="font-size: 16px;" id="tw2mode">---</span></a></td>
                                        <td class="colcentered texto-stn"><span style="font-size: 24px;" id="tw2set">---</span></td>
                                        <td class="colcentered texto-stn" colspan="2"><span style="font-size: 24px;" id="tw2nec">---</span><br></td>
                                </tr>
                                <tr>
                                        <td><span class="spanitem spanitemw" id="tw2stn1">STN1</span></td>
                                        <td class="tdstn" colspan="3"><a href="#"><span title="-5° TW2" class="spanitemtw spanitemtwy" id="tw2sp_minus" style="height: 52px; line-height: 52px; font-size: 18px;">−</span></a></td>
                                        <td class="colcentered texto-stn" colspan="3"><span style="font-size: 79px;" id="tw2">---</span></td>
                                        <td class="tdstn" colspan="3"><a href="#"><span title="+5° TW2" class="spanitemtw spanitemtwy" id="tw2sp_plus" style="height: 52px; line-height: 52px; font-size: 18px;">+</span></a></td>
                                        <td><span class="spanitem spanitemw" id="tw2stn2">STN2</span></td>
                                </tr>
                                <tr>
                                        <td colspan="5"><hr></td>
                                        <td colspan="1">Presets</td>
                                        <td colspan="5"><hr></td>
                                </tr>
                                <tr>
                                        <td class="tdstn"><a href="#"><span title="10º" onclick="send_command('tw2/set/deg', 10)" class="spanitemtw" id="tw2sp0">10º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="25º" onclick="send_command('tw2/set/deg', 25)" class="spanitemtw" id="tw2sp1">25º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="45º" onclick="send_command('tw2/set/deg', 45)" class="spanitemtw" id="tw2sp2">45º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="60º" onclick="send_command('tw2/set/deg', 60)" class="spanitemtw" id="tw2sp3">60º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="87º" onclick="send_command('tw2/set/deg', 87)" class="spanitemtw" id="tw2sp4">87º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="125º" onclick="send_command('tw2/set/deg', 125)" class="spanitemtw" id="tw2sp5">125º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="205º" onclick="send_command('tw2/set/deg', 205)" class="spanitemtw" id="tw2sp6">205º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="220º" onclick="send_command('tw2/set/deg', 220)" class="spanitemtw" id="tw2sp3">220º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="270º" onclick="send_command('tw2/set/deg', 270)" class="spanitemtw" id="tw2sp4">270º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="300º" onclick="send_command('tw2/set/deg', 300)" class="spanitemtw" id="tw2sp5">300º</span></a></td>
                                        <td class="tdstn"><a href="#"><span title="340º" onclick="send_command('tw2/set/deg', 340)" class="spanitemtw" id="tw2sp6">340º</span></a></td>
                                </tr>
                        </table>
                </div>
        </body>
</html>

<script>
  ["tw1", "tw2", "tw3"].forEach(id => {
    const el = document.getElementById(id);
    el.addEventListener("click", () => {
      const current = el.textContent.trim();
      const nuevo = prompt(`Introduce la dirección para mástil ${id.toUpperCase()}:`, current === "---" ? "" : current);

      if (nuevo !== null && nuevo.trim() !== "" && nuevo >= 0 && nuevo <= 360) {
        const valor = parseFloat(nuevo);
        if (!isNaN(valor)) {
          send_command(`${id}/set/deg`, valor);
        }
      }
    });
  });
</script>

<script>
function ajustarTw(twId, delta) {
  // ejemplo: twId = 'tw1'
  const el = document.getElementById(`${twId}set`);
  if (!el) return;

  const current = parseInt(el.textContent);
  if (isNaN(current)) return;

        let nuevo = current + delta;
        if (nuevo >= 360) nuevo = nuevo - 360;
        if (nuevo < 0)  nuevo = 360 + delta;
  send_command(`${twId}/set/deg`, nuevo);
}

// Asignar eventos a todos los botones ±5
['tw1', 'tw2', 'tw3'].forEach(tw => {
  document.getElementById(`${tw}sp_plus`).addEventListener('click', () => ajustarTw(tw, +5));
  document.getElementById(`${tw}sp_minus`).addEventListener('click', () => ajustarTw(tw, -5));
});
</script>